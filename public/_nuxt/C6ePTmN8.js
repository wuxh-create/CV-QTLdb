import{d as ue,H as _e,j as z,M as de,r as _,N as C,O as ce,I as U,v as I,A as a,z as o,P as me,Q as ye,R as ve,x as p,S as fe,B,L as xe,t as k,T as M,U as E,K as ge,y as F,V as he,W as be}from"./BTGu2dYh.js";import{_ as qe,m as we}from"./Dv2ixm1C.js";import{_ as Te,a as Ve,b as Ie,c as Ne,d as De,e as Le,f as Qe}from"./CbgbUNeg.js";import{_ as Pe,a as Be}from"./B-z2BPVc.js";import{_ as ke}from"./B4eBHn-4.js";import{_ as Se}from"./D8G4fVbO.js";import{q as $e}from"./wea4sSe8.js";import"./BQTLAjhu.js";const H=({variant_id:g,phenotype_type:r,phenotype_id:f,page:c=1,pageSize:N=10,sortBy:i="FDR",order:S=1})=>$fetch("/api/qtls_mnv",{method:"GET",params:{variant_type:"MNV",variant_id:g,phenotype_type:r,phenotype_id:f,page:c,pageSize:N,sortBy:i,order:S}}),Re=({variant_id:g,phenotype_type:r,phenotype_id:f})=>$fetch("/api/boxplot",{method:"GET",params:{variant_type:"MNV",variant_id:g,phenotype_type:r,phenotype_id:f}}),Ce=({phenotype_type:g,input:r})=>$fetch("/api/hint_phenotype",{method:"GET",params:{phenotype_type:g,input:r}}),Me={class:"column q-gutter-y-md"},Ee={class:"col-12 col-sm-6"},Fe={class:"row items-center justify-center q-gutter-x-xl"},Oe={class:"row justify-center q-pb-sm q-my-xs"},ze={class:"q-px-sm q-gutter-x-xs"},Ue={class:"row no-wrap q-pl-md q-gutter-x-lg"},He={class:"text-primary"},Ge={class:"row no-wrap"},et=ue({__name:"mnv",setup(g){const r=_e(),f=z(()=>r.screen.lt.sm),c=de(),N=_(!1),i=C({variant:"none",phenotype:"none",samples:{},data:{}}),S=n=>{Re({variant_id:n.Variant_ID,phenotype_type:n.Phenotype_type,phenotype_id:n.Phenotype_ID}).then(e=>{const s=e;if(s.data){N.value=!0,i.variant=n.Variant_ID,i.phenotype=n.Phenotype_ID;for(const l in["0","1","2"])s.data[`n_${l}`]>0?(i.samples[l]=s.data[`n_${l}`],i.data[l]=s.data[`data_${l}`].split(",").map(Number)):(i.samples[l]=0,i.data[l]=[]);console.log(i)}else r.notify({message:"No data found!",color:"negative",icon:"warning"})})},m=_(null),y=_(null),v=_(null),h=C({variant_id:null,phenotype_type:null,phenotype_id:null}),x=C({eQTL:0,sQTL:0,apaQTL:0,meQTL:0}),G=["eQTL","apaQTL","sQTL","meQTL"],b=_([]),q=_([]),L=_(null),Q=_(null),j=(n,e,s)=>{e(()=>{n===""?b.value=[]:$e({input:n}).then(l=>{const u=l;u.data.length?b.value=u.data:b.value=[n],b.value=u.data,n!==""&&L.value.options.length&&(L.value.setOptionIndex(-1),L.value.moveOptionSelection(1,!0))}).catch(l=>{b.value=[n]})}),s(()=>{})},A=(n,e,s)=>{e(()=>{n===""?q.value=[]:Ce({phenotype_type:m.value,input:n}).then(l=>{const u=l;u.data.length?q.value=u.data:q.value=[n],q.value=u.data,n!==""&&Q.value.options.length&&(Q.value.setOptionIndex(-1),Q.value.moveOptionSelection(1,!0))}).catch(l=>{q.value=[n]})}),s(()=>{})},K=z(()=>{const n=!!v.value,e=!!m.value,s=!!y.value;return n||e||s}),W=[{label:"example1",variantID:"HNMNV140207528",phenotypeType:"eQTL",phenotypeID:"ENSG00000071246.11",disable:!1},{label:"example2",variantID:"HNMNV010217172",phenotypeType:"sQTL",phenotypeID:"",disable:!1},{label:"example3",variantID:null,phenotypeType:"meQTL",phenotypeID:null,disable:!1}],J=n=>{m.value=n.phenotypeType,y.value=n.phenotypeID,v.value=n.variantID},$=_([]),w=_(!1),d=_({page:1,rowsPerPage:15,rowsNumber:0,sortBy:"FDR",descending:!1}),X=n=>{w.value=!0;const{page:e,rowsPerPage:s,sortBy:l,descending:u}=n.pagination;H({variant_id:h.variant_id,phenotype_type:h.phenotype_type,phenotype_id:h.phenotype_id,page:e,pageSize:s,sortBy:l,order:u?-1:1}).then(P=>{const D=P;$.value=D.data,d.value.rowsNumber=D.total}).finally(()=>{w.value=!1,d.value.page=e,d.value.rowsPerPage=s,d.value.sortBy=l,d.value.descending=u})},Y=_(!1),Z=()=>{r.notify({message:"Download will be not available untill published",color:"negative",icon:"warning"})},O=()=>{K.value?(w.value=!0,H({variant_id:v.value,phenotype_type:m.value,phenotype_id:y.value,page:1,pageSize:d.value.rowsPerPage,sortBy:d.value.sortBy,order:d.value.descending?-1:1}).then(n=>{const e=n;e.total?($.value=e.data,d.value.rowsNumber=e.total,h.variant_id=v.value,h.phenotype_type=m.value,h.phenotype_id=y.value,x.eQTL=e.stat.eQTL,x.sQTL=e.stat.sQTL,x.apaQTL=e.stat.apaQTL,x.meQTL=e.stat.meQTL):r.notify({message:"No data found!",color:"negative",icon:"warning"}),w.value=!1}).catch(n=>{r.notify({message:n,color:"negative",icon:"warning"}),w.value=!1})):r.notify({message:"Please input at least one field!",color:"negative",icon:"warning"})},ee=()=>{m.value=null,y.value=null,v.value=null};return ce(()=>{Object.keys(c.query).length&&(v.value=c.query.variant_id?String(c.query.variant_id):null,m.value=c.query.phenotype_type?String(c.query.phenotype_type):"eQTL",y.value=c.query.variant_id?String(c.query.variant_id):null,O())}),(n,e)=>{const s=ve,l=ye,u=me,P=Be,D=Pe,R=Ve,T=xe,te=Te,ne=Qe,oe=Le,ae=De,le=ke,se=Ne,pe=Ie,ie=Se;return I(),U(ie,{style:{"min-height":"calc(100vh - 125px)"},class:"q-pa-md"},{default:a(()=>[o(u,{modelValue:N.value,"onUpdate:modelValue":e[0]||(e[0]=t=>N.value=t)},{default:a(()=>[o(l,{style:{width:"550px",height:"500px"}},{default:a(()=>[o(s,null,{default:a(()=>[o(qe,{x_title:i.variant,y_title:i.phenotype,data:i.data,samples:i.samples},null,8,["x_title","y_title","data","samples"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(l,{flat:"",bordered:"",style:{"max-width":"1200px"},class:"q-mx-auto q-my-none"},{default:a(()=>[o(s,{class:"row q-py-none q-px-none"},{default:a(()=>e[5]||(e[5]=[p("div",{class:"full-width q-py-sm q-px-md bg-indigo-1 text-primary text-bold text-subtitle1"}," Search MNV-QTL by Variant or Phenotype ",-1)])),_:1}),o(te,{onSubmit:O,onReset:ee,class:fe([{"q-mx-auto":f.value},"q-py-sm"])},{default:a(()=>[p("div",Me,[p("div",null,[e[7]||(e[7]=p("span",{class:"text-bold text-subtitle2 text-primary q-px-sm"},"Variant ID:",-1)),o(R,{dense:"",outlined:"",clearable:"","use-input":"","hide-dropdown-icon":"","label-color":"primary",label:"Input variant ID","input-debounce":"1000",class:"q-px-sm q-py-xs","input-class":"text-primary",modelValue:v.value,"onUpdate:modelValue":e[1]||(e[1]=t=>v.value=t),options:b.value,onFilter:j,ref_key:"ref_variant_id",ref:L},{"no-option":a(()=>[o(D,null,{default:a(()=>[o(P,{class:"text-grey"},{default:a(()=>e[6]||(e[6]=[B(" No results ")])),_:1})]),_:1})]),_:1},8,["modelValue","options"])]),p("div",null,[e[8]||(e[8]=p("span",{class:"text-bold text-subtitle2 text-primary q-px-sm"},"Phenotype Type:",-1)),o(R,{dense:"",outlined:"",clearable:"","use-input":"","hide-dropdown-icon":"","label-color":"primary",label:"Select phenotype type","input-debounce":"1000",class:"q-px-sm q-py-xs","input-class":"text-primary",modelValue:m.value,"onUpdate:modelValue":e[2]||(e[2]=t=>m.value=t),options:G},null,8,["modelValue"])]),p("div",null,[e[10]||(e[10]=p("span",{class:"text-bold text-subtitle2 text-primary q-px-sm"},"Phenotype ID:",-1)),o(R,{dense:"",outlined:"",clearable:"","use-input":"","hide-dropdown-icon":"","label-color":"primary",label:"Input phenotype ID","input-debounce":"1000",class:"q-px-sm q-py-xs","input-class":"text-primary",modelValue:y.value,"onUpdate:modelValue":e[3]||(e[3]=t=>y.value=t),options:q.value,onFilter:A,ref_key:"ref_phenotype_id",ref:Q},{"no-option":a(()=>[o(D,null,{default:a(()=>[o(P,{class:"text-grey"},{default:a(()=>e[9]||(e[9]=[B(" No results ")])),_:1})]),_:1})]),_:1},8,["modelValue","options"])])]),p("div",Ee,[p("div",Fe,[o(T,{unelevated:"","no-caps":"",color:"primary",label:"Submit",type:"submit"}),o(T,{unelevated:"","no-caps":"",color:"negative",label:"Reset",type:"reset"})])])]),_:1},8,["class"]),p("div",Oe,[p("div",ze,[(I(),k(M,null,E(W,t=>o(T,{class:"text-indigo-6",key:t.label,label:t.label,dense:f.value,disable:t.disable,flat:"","no-caps":"",ripple:!1,onClick:V=>J(t)},null,8,["label","dense","disable","onClick"])),64))])])]),_:1}),o(l,{flat:"",bordered:"",style:{"max-width":"1200px"},class:"q-mx-auto q-my-md q-px-none"},{default:a(()=>[o(pe,{flat:"","row-key":"label",pagination:d.value,"onUpdate:pagination":e[4]||(e[4]=t=>d.value=t),rows:$.value,columns:ge(we),dense:f.value,loading:w.value,"rows-per-page-options":[15,50,100,0],"pagination-label":(t,V,re)=>`${t}~${V} / ${re}`,onRequest:X,separator:"cell","no-data-label":"No data",ref:"table"},{loading:a(()=>[o(ne,{showing:"",color:"primary"})]),"top-left":a(()=>[p("div",Ue,[(I(!0),k(M,null,E(Object.keys(x),t=>he((I(),k("div",{key:t,class:"col-auto text-center text-subtitle1 text-bold"},[p("div",null,F(x[t]),1),p("div",He,F(t),1)])),[[be,x[t]!==0]])),128))])]),"top-right":a(t=>[p("div",Ge,[o(T,{flat:"",dense:"",ripple:!1,icon:t.inFullscreen?"fullscreen_exit":"fullscreen",onClick:t.toggleFullscreen},null,8,["icon","onClick"]),o(T,{flat:"",dense:"",ripple:!1,loading:Y.value,icon:"file_download",onClick:Z},null,8,["loading"])])]),header:a(t=>[o(ae,{props:t},{default:a(()=>[(I(!0),k(M,null,E(t.cols,V=>(I(),U(oe,{key:V.name,props:t,class:"text-primary",style:{"font-weight":"bold","font-size":"14px"}},{default:a(()=>[B(F(V.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"body-cell-Plot":a(t=>[o(se,{key:"plot",props:t},{default:a(()=>[o(T,{size:"md",color:"primary",icon:"bar_chart",dense:"",rounded:"",outline:"",onClick:V=>S(t.row)},{default:a(()=>[o(le,null,{default:a(()=>e[11]||(e[11]=[B(" Show boxplot ")])),_:1})]),_:2},1032,["onClick"])]),_:2},1032,["props"])]),_:1},8,["pagination","rows","columns","dense","loading","pagination-label"])]),_:1})]),_:1})}}});export{et as default};
