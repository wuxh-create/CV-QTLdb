import{d as _e,H as de,j,M as ce,r as p,N as $,O as me,I as z,v as I,A as o,z as a,P as ye,Q as ve,R as fe,x as s,S as xe,B as L,L as be,t as P,T as R,U as C,K as ge,y as M,V as qe,W as he}from"./BTGu2dYh.js";import{q as we,a as Ve,b as F}from"./CtcZllzW.js";import{_ as Te,m as Ie}from"./Dv2ixm1C.js";import{_ as De,a as Se,b as Ne,c as Le,d as Pe,e as Qe,f as Be}from"./CbgbUNeg.js";import{_ as ke,a as $e}from"./B-z2BPVc.js";import{_ as Re}from"./B4eBHn-4.js";import{_ as Ce}from"./D8G4fVbO.js";import{q as Me}from"./wea4sSe8.js";import"./BQTLAjhu.js";const Oe={class:"row"},Ue={class:"col-12 col-sm-4 items-center justify-between q-my-xs"},je={class:"col-12 col-sm-8 items-center justify-between q-my-xs"},ze={class:"row"},Fe={class:"col-12 col-sm-4 items-center justify-between q-my-xs"},Ee={class:"col-12 col-sm-8 items-center justify-between q-my-xs"},He={class:"col-12 col-sm-6"},Ae={class:"row items-center justify-center q-gutter-x-xl"},Ke={class:"row justify-center q-pb-sm q-my-xs"},We={class:"q-px-sm q-gutter-x-xs"},Ge={class:"row no-wrap q-pl-md q-gutter-x-lg"},Je={class:"text-primary"},Xe={class:"row no-wrap"},pt=_e({__name:"index",setup(Ye){const b=de(),Q=j(()=>b.screen.lt.sm),c=ce(),B=p(!1),u=$({variant:"none",phenotype:"none",samples:{},data:{}}),E=n=>{we({variant_type:n.Variant_type,variant_id:n.Variant_ID,phenotype_type:n.Phenotype_type,phenotype_id:n.Phenotype_ID}).then(e=>{const i=e;if(i.data){B.value=!0,u.variant=n.Variant_ID,u.phenotype=n.Phenotype_ID;for(const l in["0","1","2"])i.data[`n_${l}`]>0?(u.samples[l]=i.data[`n_${l}`],u.data[l]=i.data[`data_${l}`].split(",").map(Number)):(u.samples[l]=0,u.data[l]=[]);console.log(u)}else b.notify({message:"No data found!",color:"negative",icon:"warning"})})},m=p(null),v=p(null),y=p(null),f=p(null),x=$({variant_type:null,variant_id:null,phenotype_type:null,phenotype_id:null}),_=$({SNP:0,MNV:0,InDel:0,SV:0,eQTL:0,sQTL:0,apaQTL:0,meQTL:0}),H=["SNP","MNV","InDel","SV"],A=["eQTL","apaQTL","sQTL","meQTL"],g=p([]),q=p([]),S=p(null),N=p(null),K=(n,e,i)=>{e(()=>{n===""?g.value=[]:Me({variant_type:y.value,input:n}).then(l=>{const r=l;r.data.length?g.value=r.data:g.value=[n],g.value=r.data,n!==""&&S.value.options.length&&(S.value.setOptionIndex(-1),S.value.moveOptionSelection(1,!0))}).catch(l=>{g.value=[n]})}),i(()=>{})},W=(n,e,i)=>{e(()=>{n===""?q.value=[]:Ve({phenotype_type:m.value,input:n}).then(l=>{const r=l;r.data.length?q.value=r.data:q.value=[n],q.value=r.data,n!==""&&N.value.options.length&&(N.value.setOptionIndex(-1),N.value.moveOptionSelection(1,!0))}).catch(l=>{q.value=[n]})}),i(()=>{})},G=j(()=>{const n=!!y.value,e=!!f.value,i=!!m.value,l=!!v.value;return n||e||i||l}),J=[{label:"example1",variantType:"InDel",variantID:null,phenotypeType:"eQTL",phenotypeID:null,disable:!1},{label:"example2",variantType:"SV",variantID:null,phenotypeType:"sQTL",phenotypeID:null,disable:!1},{label:"example3",variantType:"MNV",variantID:null,phenotypeType:"meQTL",phenotypeID:null,disable:!1}],X=n=>{m.value=n.phenotypeType,v.value=n.phenotypeID,y.value=n.variantType,f.value=n.variantID},k=p([]),h=p(!1),d=p({page:1,rowsPerPage:15,rowsNumber:0,sortBy:"FDR",descending:!1}),Y=n=>{h.value=!0;const{page:e,rowsPerPage:i,sortBy:l,descending:r}=n.pagination;F({variant_type:x.variant_type,variant_id:x.variant_id,phenotype_type:x.phenotype_type,phenotype_id:x.phenotype_id,page:e,pageSize:i,sortBy:l,order:r?-1:1}).then(w=>{const D=w;k.value=D.data,d.value.rowsNumber=D.total}).finally(()=>{h.value=!1,d.value.page=e,d.value.rowsPerPage=i,d.value.sortBy=l,d.value.descending=r})},Z=p(!1),ee=()=>{b.notify({message:"Download will be not available untill published",color:"negative",icon:"warning"})},O=()=>{G.value?(h.value=!0,F({variant_type:y.value,variant_id:f.value,phenotype_type:m.value,phenotype_id:v.value,page:1,pageSize:d.value.rowsPerPage,sortBy:d.value.sortBy,order:d.value.descending?-1:1}).then(n=>{const e=n;e.total?(k.value=e.data,d.value.rowsNumber=e.total,x.variant_type=y.value,x.variant_id=f.value,x.phenotype_type=m.value,x.phenotype_id=v.value,_.SNP=e.stat.SNP,_.MNV=e.stat.MNV,_.InDel=e.stat.InDel,_.SV=e.stat.SV,_.eQTL=e.stat.eQTL,_.sQTL=e.stat.sQTL,_.apaQTL=e.stat.apaQTL,_.meQTL=e.stat.meQTL):b.notify({message:"No data found!",color:"negative",icon:"warning"}),h.value=!1}).catch(n=>{b.notify({message:n,color:"negative",icon:"warning"}),h.value=!1})):b.notify({message:"Please input at least one field!",color:"negative",icon:"warning"})},te=()=>{m.value=null,v.value=null,y.value=null,f.value=null};return me(()=>{Object.keys(c.query).length&&(y.value=c.query.variant_type?String(c.query.variant_type):"SV",f.value=c.query.variant_id?String(c.query.variant_id):null,m.value=c.query.phenotype_type?String(c.query.phenotype_type):"eQTL",v.value=c.query.variant_id?String(c.query.variant_id):null,O())}),(n,e)=>{const i=fe,l=ve,r=ye,w=Se,D=$e,U=ke,V=be,ne=De,ae=Be,oe=Qe,le=Pe,se=Re,ie=Le,pe=Ne,re=Ce;return I(),z(re,{style:{"min-height":"calc(100vh - 125px)"},class:"q-pa-md"},{default:o(()=>[a(r,{modelValue:B.value,"onUpdate:modelValue":e[0]||(e[0]=t=>B.value=t)},{default:o(()=>[a(l,{style:{width:"550px",height:"500px"}},{default:o(()=>[a(i,null,{default:o(()=>[a(Te,{x_title:u.variant,y_title:u.phenotype,data:u.data,samples:u.samples},null,8,["x_title","y_title","data","samples"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(l,{flat:"",bordered:"",style:{"max-width":"1200px"},class:"q-mx-auto q-my-none"},{default:o(()=>[a(i,{class:"row q-py-none q-px-none"},{default:o(()=>e[6]||(e[6]=[s("div",{class:"full-width q-py-sm q-px-md bg-indigo-1 text-primary text-bold text-subtitle1"}," Search MolQTL by Variant or Phenotype ",-1)])),_:1}),a(ne,{onSubmit:O,onReset:te,class:xe([{"q-mx-auto":Q.value},"q-py-sm"])},{default:o(()=>[s("div",Oe,[s("div",Ue,[e[7]||(e[7]=s("span",{class:"text-bold text-subtitle2 text-primary q-px-sm"},"Variant Type:",-1)),a(w,{dense:"",outlined:"",clearable:"","use-input":"","hide-dropdown-icon":"","label-color":"primary",label:"Select variant type","input-debounce":"1000",class:"col-sm-4 col-12 q-px-sm q-py-xs","input-class":"text-primary",modelValue:y.value,"onUpdate:modelValue":e[1]||(e[1]=t=>y.value=t),options:H},null,8,["modelValue"])]),s("div",je,[e[9]||(e[9]=s("span",{class:"text-bold text-subtitle2 text-primary q-px-sm"},"Variant ID:",-1)),a(w,{dense:"",outlined:"",clearable:"","use-input":"","hide-dropdown-icon":"","label-color":"primary",label:"Input variant ID","input-debounce":"1000",class:"col-12 col-sm-8 q-px-sm q-py-xs","input-class":"text-primary",modelValue:f.value,"onUpdate:modelValue":e[2]||(e[2]=t=>f.value=t),options:g.value,onFilter:K,ref_key:"ref_variant_id",ref:S},{"no-option":o(()=>[a(U,null,{default:o(()=>[a(D,{class:"text-grey"},{default:o(()=>e[8]||(e[8]=[L(" No results ")])),_:1})]),_:1})]),_:1},8,["modelValue","options"])])]),s("div",ze,[s("div",Fe,[e[10]||(e[10]=s("span",{class:"text-bold text-subtitle2 text-primary q-px-sm"},"Phenotype Type:",-1)),a(w,{dense:"",outlined:"",clearable:"","use-input":"","hide-dropdown-icon":"","label-color":"primary",label:"Select phenotype type","input-debounce":"1000",class:"col-sm-10 col-12 q-px-sm q-py-xs","input-class":"text-primary",modelValue:m.value,"onUpdate:modelValue":e[3]||(e[3]=t=>m.value=t),options:A},null,8,["modelValue"])]),s("div",Ee,[e[12]||(e[12]=s("span",{class:"text-bold text-subtitle2 text-primary q-px-sm"},"Phenotype ID:",-1)),a(w,{dense:"",outlined:"",clearable:"","use-input":"","hide-dropdown-icon":"","label-color":"primary",label:"Input phenotype ID","input-debounce":"1000",class:"col-sm-4 col-12 q-px-sm q-py-xs","input-class":"text-primary",modelValue:v.value,"onUpdate:modelValue":e[4]||(e[4]=t=>v.value=t),options:q.value,onFilter:W,ref_key:"ref_phenotype_id",ref:N},{"no-option":o(()=>[a(U,null,{default:o(()=>[a(D,{class:"text-grey"},{default:o(()=>e[11]||(e[11]=[L(" No results ")])),_:1})]),_:1})]),_:1},8,["modelValue","options"])])]),s("div",He,[s("div",Ae,[a(V,{unelevated:"","no-caps":"",color:"primary",label:"Submit",type:"submit"}),a(V,{unelevated:"","no-caps":"",color:"negative",label:"Reset",type:"reset"})])])]),_:1},8,["class"]),s("div",Ke,[s("div",We,[(I(),P(R,null,C(J,t=>a(V,{class:"text-indigo-6",key:t.label,label:t.label,dense:Q.value,disable:t.disable,flat:"","no-caps":"",ripple:!1,onClick:T=>X(t)},null,8,["label","dense","disable","onClick"])),64))])])]),_:1}),a(l,{flat:"",bordered:"",style:{"max-width":"1200px"},class:"q-mx-auto q-my-md q-px-none"},{default:o(()=>[a(pe,{flat:"","row-key":"label",pagination:d.value,"onUpdate:pagination":e[5]||(e[5]=t=>d.value=t),rows:k.value,columns:ge(Ie),dense:Q.value,loading:h.value,"rows-per-page-options":[15,50,100,0],"pagination-label":(t,T,ue)=>`${t}~${T} / ${ue}`,onRequest:Y,separator:"cell","no-data-label":"No data",ref:"table"},{loading:o(()=>[a(ae,{showing:"",color:"primary"})]),"top-left":o(()=>[s("div",Ge,[(I(!0),P(R,null,C(Object.keys(_),t=>qe((I(),P("div",{key:t,class:"col-auto text-center text-subtitle1 text-bold"},[s("div",null,M(_[t]),1),s("div",Je,M(t),1)])),[[he,_[t]!==0]])),128))])]),"top-right":o(t=>[s("div",Xe,[a(V,{flat:"",dense:"",ripple:!1,icon:t.inFullscreen?"fullscreen_exit":"fullscreen",onClick:t.toggleFullscreen},null,8,["icon","onClick"]),a(V,{flat:"",dense:"",ripple:!1,loading:Z.value,icon:"file_download",onClick:ee},null,8,["loading"])])]),header:o(t=>[a(le,{props:t},{default:o(()=>[(I(!0),P(R,null,C(t.cols,T=>(I(),z(oe,{key:T.name,props:t,class:"text-primary",style:{"font-weight":"bold","font-size":"14px"}},{default:o(()=>[L(M(T.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"body-cell-Plot":o(t=>[a(ie,{key:"plot",props:t},{default:o(()=>[a(V,{size:"md",color:"primary",icon:"bar_chart",dense:"",rounded:"",outline:"",onClick:T=>E(t.row)},{default:o(()=>[a(se,null,{default:o(()=>e[13]||(e[13]=[L(" Show boxplot ")])),_:1})]),_:2},1032,["onClick"])]),_:2},1032,["props"])]),_:1},8,["pagination","rows","columns","dense","loading","pagination-label"])]),_:1})]),_:1})}}});export{pt as default};
