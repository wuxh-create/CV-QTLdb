import{d as _e,H as pe,j as G,M as me,r as i,N as U,O as ve,I as j,v as N,A as o,z as a,P as ye,Q as fe,R as ge,x as l,S as xe,B as D,L as be,t as R,T as M,U as O,K as qe,y as Q,V as we,W as he}from"./BTGu2dYh.js";import{m as Ne}from"./DUAdsSfe.js";import{_ as Ie}from"./3Ht2rspR.js";import{_ as Ve,a as Se,b as Be,c as Pe,d as Te,e as ke,f as De}from"./CbgbUNeg.js";import{_ as Re,a as $e}from"./B-z2BPVc.js";import{_ as Ce}from"./B4eBHn-4.js";import{_ as Ee}from"./D8G4fVbO.js";import{q as He}from"./wea4sSe8.js";import"./BQTLAjhu.js";const A=({variant_id:g,indicator_type:c,indicator_name:I,page:d=1,pageSize:V=10,sortBy:P="FDR",order:$=1})=>$fetch("/api/gwas_snp",{method:"GET",params:{variant_type:"SNP",variant_id:g,indicator_type:c,indicator_name:I,page:d,pageSize:V,sortBy:P,order:$}}),Fe=({indicator_type:g,indicator_name:c})=>$fetch("/api/manhattan",{method:"GET",params:{variant_type:"SNP",indicator_type:g,indicator_name:c}}),Me=({indicator_type:g,input:c})=>$fetch("/api/hint_indicator",{method:"GET",params:{indicator_type:g,input:c}}),Oe={class:"col-12 items-center justify-between q-my-xs"},Qe={class:"col-12 items-center justify-between q-my-xs"},ze={class:"col-12 items-center justify-between q-my-xs"},Ge={class:"col-12"},Ue={class:"row items-center justify-center q-gutter-x-xl"},je={class:"row justify-center q-pb-sm q-my-xs"},Ae={class:"q-px-sm q-gutter-x-xs"},Le={class:"row no-wrap q-pl-md q-gutter-x-lg"},We={class:"text-primary"},Ke={class:"row no-wrap"},lt=_e({__name:"snp",setup(g){const c=pe(),I=G(()=>c.screen.lt.sm),d=me(),V=i(!1),P=i(""),$=n=>{Fe({variant_type:n.Variant_type,indicator_type:n.Indicator_type,indicator_name:n.Indicator_name}).then(e=>{const r=e;r.data?(V.value=!0,P.value=r.data.figure_base64_code):c.notify({message:"No data found!",color:"negative",icon:"warning"})})},p=i(null),v=i(null),S=i(null),y=i(null),f=U({variant_type:null,variant_id:null,indicator_type:null,indicator_name:null}),m=U({Pathology:0,Nutrition:0,Toxin:0,Measurement:0,Hormone:0,Questionnaire:0}),L=["Pathology","Nutrition","Toxin","Measurement","Hormone","Questionnaire"],x=i([]),b=i([]),T=i(null),k=i(null),W=(n,e,r)=>{e(()=>{n===""?x.value=[]:He({variant_type:S.value,input:n}).then(u=>{const s=u;s.data.length?x.value=s.data:x.value=[n],x.value=s.data,n!==""&&T.value.options.length&&(T.value.setOptionIndex(-1),T.value.moveOptionSelection(1,!0))}).catch(u=>{x.value=[n]})}),r(()=>{})},K=(n,e,r)=>{e(()=>{n===""?b.value=[]:Me({indicator_type:p.value,input:n}).then(u=>{const s=u;s.data.length?b.value=s.data:b.value=[n],b.value=s.data,n!==""&&k.value.options.length&&(k.value.setOptionIndex(-1),k.value.moveOptionSelection(1,!0))}).catch(u=>{b.value=[n]})}),r(()=>{})},J=G(()=>{const n=!!S.value,e=!!y.value,r=!!p.value,u=!!v.value;return n||e||r||u}),X=[{label:"example1",variantID:null,indicatorType:"Pathology",indicatorName:null,disable:!1},{label:"example2",variantID:null,indicatorType:null,indicatorName:"Hemoglobin",disable:!1},{label:"example3",variantID:"chr11_61753846_G_A",indicatorType:null,indicatorName:null,disable:!1}],Y=n=>{p.value=n.indicatorType,v.value=n.indicatorName,S.value=n.variantType,y.value=n.variantID},C=i([]),q=i(!1),_=i({page:1,rowsPerPage:15,rowsNumber:0,sortBy:"FDR",descending:!1}),Z=n=>{q.value=!0;const{page:e,rowsPerPage:r,sortBy:u,descending:s}=n.pagination;A({variant_type:f.variant_type,variant_id:f.variant_id,indicator_type:f.indicator_type,indicator_name:f.indicator_name,page:e,pageSize:r,sortBy:u,order:s?-1:1}).then(H=>{const B=H;C.value=B.data,_.value.rowsNumber=B.total}).finally(()=>{q.value=!1,_.value.page=e,_.value.rowsPerPage=r,_.value.sortBy=u,_.value.descending=s})},ee=i(!1),te=()=>{c.notify({message:"Download will be not available untill published",color:"negative",icon:"warning"})},E=()=>{J.value?(q.value=!0,A({variant_id:y.value,indicator_type:p.value,indicator_name:v.value,page:1,pageSize:_.value.rowsPerPage,sortBy:_.value.sortBy,order:_.value.descending?-1:1}).then(n=>{const e=n;e.total?(C.value=e.data,_.value.rowsNumber=e.total,f.variant_id=y.value,f.indicator_type=p.value,f.indicator_name=v.value,m.Pathology=e.stat.Pathology,m.Nutrition=e.stat.Nutrition,m.Toxin=e.stat.Toxin,m.Measurement=e.stat.Measurement,m.Hormone=e.stat.Hormone,m.Questionnaire=e.stat.Questionnaire):c.notify({message:"No data found!",color:"negative",icon:"warning"}),q.value=!1}).catch(n=>{c.notify({message:n,color:"negative",icon:"warning"}),q.value=!1})):c.notify({message:"Please input at least one field!",color:"negative",icon:"warning"})},ne=()=>{p.value=null,v.value=null,S.value=null,y.value=null};return ve(()=>{Object.keys(d.query).length?(S.value=d.query.variant_type?String(d.query.variant_type):"SV",y.value=d.query.variant_id?String(d.query.variant_id):null,p.value=d.query.indicator_type?String(d.query.indicator_type):"eQTL",v.value=d.query.variant_id?String(d.query.variant_id):null,E()):(p.value="Pathology",E())}),(n,e)=>{const r=Ie,u=ge,s=fe,H=ye,B=$e,z=Re,F=Se,w=be,ae=Ve,oe=De,le=ke,se=Te,ie=Ce,re=Pe,ue=Be,ce=Ee;return N(),j(ce,{style:{"min-height":"calc(100vh - 125px)"},class:"q-pa-md"},{default:o(()=>[a(H,{modelValue:V.value,"onUpdate:modelValue":e[0]||(e[0]=t=>V.value=t)},{default:o(()=>[a(s,{style:{width:"600px",height:"480px"}},{default:o(()=>[a(u,null,{default:o(()=>[a(r,{src:"data:image/png;base64,"+P.value,"spinner-color":"white",fit:"scale-down"},null,8,["src"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(s,{flat:"",bordered:"",style:{"max-width":"1140px"},class:"q-mx-auto q-my-none"},{default:o(()=>[a(u,{class:"row q-py-none q-px-none"},{default:o(()=>e[5]||(e[5]=[l("div",{class:"full-width q-py-sm q-px-md bg-indigo-1 text-primary text-bold text-subtitle1"}," Search SNV-GWAS by Variant or Indicator ",-1)])),_:1}),a(ae,{onSubmit:E,onReset:ne,class:xe([{"q-mx-auto":I.value},"q-py-sm"])},{default:o(()=>[l("div",Oe,[e[7]||(e[7]=l("span",{class:"text-bold text-subtitle2 text-primary q-px-sm"},"Variant ID:",-1)),a(F,{dense:"",outlined:"",clearable:"","use-input":"","hide-dropdown-icon":"","label-color":"primary",label:"Input variant ID","input-debounce":"1000",class:"col-12 q-px-sm q-py-xs","input-class":"text-primary",modelValue:y.value,"onUpdate:modelValue":e[1]||(e[1]=t=>y.value=t),options:x.value,onFilter:W,ref_key:"ref_variant_id",ref:T},{"no-option":o(()=>[a(z,null,{default:o(()=>[a(B,{class:"text-grey"},{default:o(()=>e[6]||(e[6]=[D(" No results ")])),_:1})]),_:1})]),_:1},8,["modelValue","options"])]),l("div",Qe,[e[8]||(e[8]=l("span",{class:"text-bold text-subtitle2 text-primary q-px-sm"},"Indicator Type:",-1)),a(F,{dense:"",outlined:"",clearable:"","use-input":"","hide-dropdown-icon":"","label-color":"primary",label:"Select indicator type","input-debounce":"1000",class:"col-12 q-px-sm q-py-xs","input-class":"text-primary",modelValue:p.value,"onUpdate:modelValue":e[2]||(e[2]=t=>p.value=t),options:L},null,8,["modelValue"])]),l("div",ze,[e[10]||(e[10]=l("span",{class:"text-bold text-subtitle2 text-primary q-px-sm"},"Indicator name:",-1)),a(F,{dense:"",outlined:"",clearable:"","use-input":"","hide-dropdown-icon":"","label-color":"primary",label:"Input indicator name","input-debounce":"1000",class:"col-12 q-px-sm q-py-xs","input-class":"text-primary",modelValue:v.value,"onUpdate:modelValue":e[3]||(e[3]=t=>v.value=t),options:b.value,onFilter:K,ref_key:"ref_indicator_name",ref:k},{"no-option":o(()=>[a(z,null,{default:o(()=>[a(B,{class:"text-grey"},{default:o(()=>e[9]||(e[9]=[D(" No results ")])),_:1})]),_:1})]),_:1},8,["modelValue","options"])]),l("div",Ge,[l("div",Ue,[a(w,{unelevated:"","no-caps":"",color:"primary",label:"Submit",type:"submit"}),a(w,{unelevated:"","no-caps":"",color:"negative",label:"Reset",type:"reset"})])])]),_:1},8,["class"]),l("div",je,[l("div",Ae,[(N(),R(M,null,O(X,t=>a(w,{class:"text-indigo-6",key:t.label,label:t.label,dense:I.value,disable:t.disable,flat:"","no-caps":"",ripple:!1,onClick:h=>Y(t)},null,8,["label","dense","disable","onClick"])),64))])])]),_:1}),a(s,{flat:"",bordered:"",style:{"max-width":"1140px"},class:"q-mx-auto q-my-md q-px-none"},{default:o(()=>[a(ue,{flat:"","row-key":"label",pagination:_.value,"onUpdate:pagination":e[4]||(e[4]=t=>_.value=t),rows:C.value,columns:qe(Ne),dense:I.value,loading:q.value,"rows-per-page-options":[15,50,100],"rows-per-page-label":"Rows per page:","pagination-label":(t,h,de)=>`${t}~${h} / ${de}`,onRequest:Z,separator:"cell","no-data-label":"No data"},{loading:o(()=>[a(oe,{showing:"",color:"primary"})]),"top-left":o(()=>[l("div",Le,[(N(!0),R(M,null,O(Object.keys(m),t=>we((N(),R("div",{key:t,class:"col-auto text-center text-subtitle1 text-bold"},[l("div",null,Q(m[t]),1),l("div",We,Q(t),1)])),[[he,m[t]!==0]])),128))])]),"top-right":o(t=>[l("div",Ke,[a(w,{flat:"",dense:"",ripple:!1,icon:t.inFullscreen?"fullscreen_exit":"fullscreen",onClick:t.toggleFullscreen},null,8,["icon","onClick"]),a(w,{flat:"",dense:"",ripple:!1,loading:ee.value,icon:"file_download",onClick:te},null,8,["loading"])])]),header:o(t=>[a(se,{props:t},{default:o(()=>[(N(!0),R(M,null,O(t.cols,h=>(N(),j(le,{key:h.name,props:t,class:"text-primary",style:{"font-weight":"bold","font-size":"14px"}},{default:o(()=>[D(Q(h.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"body-cell-Plot":o(t=>[a(re,{key:"plot",props:t},{default:o(()=>[a(w,{size:"md",color:"primary",icon:"bar_chart",dense:"",rounded:"",outline:"",onClick:h=>$(t.row)},{default:o(()=>[a(ie,null,{default:o(()=>e[11]||(e[11]=[D(" Show boxplot ")])),_:1})]),_:2},1032,["onClick"])]),_:2},1032,["props"])]),_:1},8,["pagination","rows","columns","dense","loading","pagination-label"])]),_:1})]),_:1})}}});export{lt as default};
