import{d as ue,H as _e,j as O,M as de,r as _,N as G,O as ce,I as z,v as D,A as a,z as o,P as me,Q as ye,R as ve,x as i,S as fe,B as C,L as xe,t as N,T as R,U as A,K as he,y as E,V as ge,W as be}from"./BTGu2dYh.js";import{_ as qe,m as we}from"./Dv2ixm1C.js";import{_ as Te,a as Ie,b as De,c as Le,d as Qe,e as Ve,f as Pe}from"./CbgbUNeg.js";import{_ as Be,a as Ce}from"./B-z2BPVc.js";import{_ as Ne}from"./B4eBHn-4.js";import{_ as ke}from"./D8G4fVbO.js";import{q as Se}from"./wea4sSe8.js";import"./BQTLAjhu.js";const U=({variant_id:h,phenotype_type:r,phenotype_id:f,page:c=1,pageSize:L=10,sortBy:p="FDR",order:k=1})=>$fetch("/api/qtls_indel",{method:"GET",params:{variant_type:"InDel",variant_id:h,phenotype_type:r,phenotype_id:f,page:c,pageSize:L,sortBy:p,order:k}}),$e=({variant_id:h,phenotype_type:r,phenotype_id:f})=>$fetch("/api/boxplot",{method:"GET",params:{variant_type:"InDel",variant_id:h,phenotype_type:r,phenotype_id:f}}),Ge=({phenotype_type:h,input:r})=>$fetch("/api/hint_phenotype",{method:"GET",params:{phenotype_type:h,input:r}}),Re={class:"column q-gutter-y-md"},Ae={class:"col-12 col-sm-6"},Ee={class:"row items-center justify-center q-gutter-x-xl"},Fe={class:"row justify-center q-pb-sm q-my-xs"},Oe={class:"q-px-sm q-gutter-x-xs"},ze={class:"row no-wrap q-pl-md q-gutter-x-lg"},Ue={class:"text-primary"},je={class:"row no-wrap"},et=ue({__name:"indel",setup(h){const r=_e(),f=O(()=>r.screen.lt.sm),c=de(),L=_(!1),p=G({variant:"none",phenotype:"none",samples:{},data:{}}),k=n=>{$e({variant_id:n.Variant_ID,phenotype_type:n.Phenotype_type,phenotype_id:n.Phenotype_ID}).then(e=>{const s=e;if(s.data){L.value=!0,p.variant=n.Variant_ID,p.phenotype=n.Phenotype_ID;for(const l in["0","1","2"])s.data[`n_${l}`]>0?(p.samples[l]=s.data[`n_${l}`],p.data[l]=s.data[`data_${l}`].split(",").map(Number)):(p.samples[l]=0,p.data[l]=[]);console.log(p)}else r.notify({message:"No data found!",color:"negative",icon:"warning"})})},m=_(null),y=_(null),v=_(null),g=G({variant_id:null,phenotype_type:null,phenotype_id:null}),x=G({eQTL:0,sQTL:0,apaQTL:0,meQTL:0}),j=["eQTL","apaQTL","sQTL","meQTL"],b=_([]),q=_([]),V=_(null),P=_(null),H=(n,e,s)=>{e(()=>{n===""?b.value=[]:Se({input:n}).then(l=>{const u=l;u.data.length?b.value=u.data:b.value=[n],b.value=u.data,n!==""&&V.value.options.length&&(V.value.setOptionIndex(-1),V.value.moveOptionSelection(1,!0))}).catch(l=>{b.value=[n]})}),s(()=>{})},M=(n,e,s)=>{e(()=>{n===""?q.value=[]:Ge({phenotype_type:m.value,input:n}).then(l=>{const u=l;u.data.length?q.value=u.data:q.value=[n],q.value=u.data,n!==""&&P.value.options.length&&(P.value.setOptionIndex(-1),P.value.moveOptionSelection(1,!0))}).catch(l=>{q.value=[n]})}),s(()=>{})},K=O(()=>{const n=!!v.value,e=!!m.value,s=!!y.value;return n||e||s}),W=[{label:"example1",variantID:"chr14_76726181_GGCGCCCGCCACC_G",phenotypeType:"eQTL",phenotypeID:"ENSG00000071246.11",disable:!1},{label:"example2",variantID:"chr12_128849462_TAGAAAAGAGATA_T",phenotypeType:"sQTL",phenotypeID:"",disable:!1},{label:"example3",variantID:null,phenotypeType:"apaQTL",phenotypeID:null,disable:!1}],J=n=>{m.value=n.phenotypeType,y.value=n.phenotypeID,v.value=n.variantID},S=_([]),w=_(!1),d=_({page:1,rowsPerPage:15,rowsNumber:0,sortBy:"FDR",descending:!1}),X=n=>{w.value=!0;const{page:e,rowsPerPage:s,sortBy:l,descending:u}=n.pagination;U({variant_id:g.variant_id,phenotype_type:g.phenotype_type,phenotype_id:g.phenotype_id,page:e,pageSize:s,sortBy:l,order:u?-1:1}).then(B=>{const Q=B;S.value=Q.data,d.value.rowsNumber=Q.total}).finally(()=>{w.value=!1,d.value.page=e,d.value.rowsPerPage=s,d.value.sortBy=l,d.value.descending=u})},Y=_(!1),Z=()=>{r.notify({message:"Download will be not available untill published",color:"negative",icon:"warning"})},F=()=>{K.value?(w.value=!0,U({variant_id:v.value,phenotype_type:m.value,phenotype_id:y.value,page:1,pageSize:d.value.rowsPerPage,sortBy:d.value.sortBy,order:d.value.descending?-1:1}).then(n=>{const e=n;e.total?(S.value=e.data,d.value.rowsNumber=e.total,g.variant_id=v.value,g.phenotype_type=m.value,g.phenotype_id=y.value,x.eQTL=e.stat.eQTL,x.sQTL=e.stat.sQTL,x.apaQTL=e.stat.apaQTL,x.meQTL=e.stat.meQTL):r.notify({message:"No data found!",color:"negative",icon:"warning"}),w.value=!1}).catch(n=>{r.notify({message:n,color:"negative",icon:"warning"}),w.value=!1})):r.notify({message:"Please input at least one field!",color:"negative",icon:"warning"})},ee=()=>{m.value=null,y.value=null,v.value=null};return ce(()=>{Object.keys(c.query).length&&(v.value=c.query.variant_id?String(c.query.variant_id):null,m.value=c.query.phenotype_type?String(c.query.phenotype_type):"eQTL",y.value=c.query.variant_id?String(c.query.variant_id):null,F())}),(n,e)=>{const s=ve,l=ye,u=me,B=Ce,Q=Be,$=Ie,T=xe,te=Te,ne=Pe,oe=Ve,ae=Qe,le=Ne,se=Le,ie=De,pe=ke;return D(),z(pe,{style:{"min-height":"calc(100vh - 125px)"},class:"q-pa-md"},{default:a(()=>[o(u,{modelValue:L.value,"onUpdate:modelValue":e[0]||(e[0]=t=>L.value=t)},{default:a(()=>[o(l,{style:{width:"550px",height:"500px"}},{default:a(()=>[o(s,null,{default:a(()=>[o(qe,{x_title:p.variant,y_title:p.phenotype,data:p.data,samples:p.samples},null,8,["x_title","y_title","data","samples"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(l,{flat:"",bordered:"",style:{"max-width":"1200px"},class:"q-mx-auto q-my-none"},{default:a(()=>[o(s,{class:"row q-py-none q-px-none"},{default:a(()=>e[5]||(e[5]=[i("div",{class:"full-width q-py-sm q-px-md bg-indigo-1 text-primary text-bold text-subtitle1"}," Search InDel-QTL by Variant or Phenotype ",-1)])),_:1}),o(te,{onSubmit:F,onReset:ee,class:fe([{"q-mx-auto":f.value},"q-py-sm"])},{default:a(()=>[i("div",Re,[i("div",null,[e[7]||(e[7]=i("span",{class:"text-bold text-subtitle2 text-primary q-px-sm"},"Variant ID:",-1)),o($,{dense:"",outlined:"",clearable:"","use-input":"","hide-dropdown-icon":"","label-color":"primary",label:"Input variant ID","input-debounce":"1000",class:"q-px-sm q-py-xs","input-class":"text-primary",modelValue:v.value,"onUpdate:modelValue":e[1]||(e[1]=t=>v.value=t),options:b.value,onFilter:H,ref_key:"ref_variant_id",ref:V},{"no-option":a(()=>[o(Q,null,{default:a(()=>[o(B,{class:"text-grey"},{default:a(()=>e[6]||(e[6]=[C(" No results ")])),_:1})]),_:1})]),_:1},8,["modelValue","options"])]),i("div",null,[e[8]||(e[8]=i("span",{class:"text-bold text-subtitle2 text-primary q-px-sm"},"Phenotype Type:",-1)),o($,{dense:"",outlined:"",clearable:"","use-input":"","hide-dropdown-icon":"","label-color":"primary",label:"Select phenotype type","input-debounce":"1000",class:"q-px-sm q-py-xs","input-class":"text-primary",modelValue:m.value,"onUpdate:modelValue":e[2]||(e[2]=t=>m.value=t),options:j},null,8,["modelValue"])]),i("div",null,[e[10]||(e[10]=i("span",{class:"text-bold text-subtitle2 text-primary q-px-sm"},"Phenotype ID:",-1)),o($,{dense:"",outlined:"",clearable:"","use-input":"","hide-dropdown-icon":"","label-color":"primary",label:"Input phenotype ID","input-debounce":"1000",class:"q-px-sm q-py-xs","input-class":"text-primary",modelValue:y.value,"onUpdate:modelValue":e[3]||(e[3]=t=>y.value=t),options:q.value,onFilter:M,ref_key:"ref_phenotype_id",ref:P},{"no-option":a(()=>[o(Q,null,{default:a(()=>[o(B,{class:"text-grey"},{default:a(()=>e[9]||(e[9]=[C(" No results ")])),_:1})]),_:1})]),_:1},8,["modelValue","options"])])]),i("div",Ae,[i("div",Ee,[o(T,{unelevated:"","no-caps":"",color:"primary",label:"Submit",type:"submit"}),o(T,{unelevated:"","no-caps":"",color:"negative",label:"Reset",type:"reset"})])])]),_:1},8,["class"]),i("div",Fe,[i("div",Oe,[(D(),N(R,null,A(W,t=>o(T,{class:"text-indigo-6",key:t.label,label:t.label,dense:f.value,disable:t.disable,flat:"","no-caps":"",ripple:!1,onClick:I=>J(t)},null,8,["label","dense","disable","onClick"])),64))])])]),_:1}),o(l,{flat:"",bordered:"",style:{"max-width":"1200px"},class:"q-mx-auto q-my-md q-px-none"},{default:a(()=>[o(ie,{flat:"","row-key":"label",pagination:d.value,"onUpdate:pagination":e[4]||(e[4]=t=>d.value=t),rows:S.value,columns:he(we),dense:f.value,loading:w.value,"rows-per-page-options":[15,50,100,0],"pagination-label":(t,I,re)=>`${t}~${I} / ${re}`,onRequest:X,separator:"cell","no-data-label":"No data",ref:"table"},{loading:a(()=>[o(ne,{showing:"",color:"primary"})]),"top-left":a(()=>[i("div",ze,[(D(!0),N(R,null,A(Object.keys(x),t=>ge((D(),N("div",{key:t,class:"col-auto text-center text-subtitle1 text-bold"},[i("div",null,E(x[t]),1),i("div",Ue,E(t),1)])),[[be,x[t]!==0]])),128))])]),"top-right":a(t=>[i("div",je,[o(T,{flat:"",dense:"",ripple:!1,icon:t.inFullscreen?"fullscreen_exit":"fullscreen",onClick:t.toggleFullscreen},null,8,["icon","onClick"]),o(T,{flat:"",dense:"",ripple:!1,loading:Y.value,icon:"file_download",onClick:Z},null,8,["loading"])])]),header:a(t=>[o(ae,{props:t},{default:a(()=>[(D(!0),N(R,null,A(t.cols,I=>(D(),z(oe,{key:I.name,props:t,class:"text-primary",style:{"font-weight":"bold","font-size":"14px"}},{default:a(()=>[C(E(I.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"body-cell-Plot":a(t=>[o(se,{key:"plot",props:t},{default:a(()=>[o(T,{size:"md",color:"primary",icon:"bar_chart",dense:"",rounded:"",outline:"",onClick:I=>k(t.row)},{default:a(()=>[o(le,null,{default:a(()=>e[11]||(e[11]=[C(" Show boxplot ")])),_:1})]),_:2},1032,["onClick"])]),_:2},1032,["props"])]),_:1},8,["pagination","rows","columns","dense","loading","pagination-label"])]),_:1})]),_:1})}}});export{et as default};
